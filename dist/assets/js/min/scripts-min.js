function csgPos(){return chapterSlideGrid.getBoundingClientRect().top}function chapterMenuPos(){return chapterMenu.getBoundingClientRect().top}function titleSVGPos(){return titleSVG.getBoundingClientRect().top}function draw(e,t,n,o){return e.paused||e.ended?!1:(t.drawImage(e,0,0,n,o),void window.requestAnimationFrame(function(){draw(e,t,n,o)}))}function get(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("GET",e),o.onload=function(){200===o.status?t(o.response):n(Error(o.statusText))},o.onerror=function(){n(Error("Network Error"))},o.send()})}function getChapter(e){get("assets/js/chapters.json").then(JSON.parse).then(function(t){function n(){get(r).then(function(e){chapterContainer.innerHTML=e})}var o=e+1;t.chapters[e].number>"0"&&(home.style.display="none"),chapter.style.display="none",chapterMenu.classList.remove("sticky"),window.scrollTo(0,0),v.src=t.chapters[e].video_path,vw>600?v.playbackRate=.2:v.pause();var r=t.chapters[e].path;e>0&&n();for(var c=0;c<chapterButton.length;c++)chapterButton[c].classList.remove("active");chapterButton[e].classList.add("active"),4>e&&(nextButton.innerHTML="Next: Chapter "+t.chapters[o].number+" - "+t.chapters[o].title,nextButton.addEventListener("click",function(){getChapter(o)},!1)),4===e&&(nextButton.innerHTML="Please consider supporting Fallow Media and helping us to continue our work.",nextButton.href="https://www.patreon.com/fallowmedia",nextButton.target="_blank",nextButton.rel="noopener",nextButton.addEventListener("click",function(){getChapter(4)},!1))},function(e){console.error("Failed!",e)})}function floatingNav(){floatingNavLink.forEach(function(e,t){floatingNavLink[t].addEventListener("click",function(){var e=t+1;getChapter(e)})})}var titleSVG=document.querySelector(".c-home__title--background"),chapterSlideGrid=document.querySelector(".c-chapter-slide"),chapterMenu=document.querySelector(".c-chapter-menu"),vh=window.innerHeight,home=document.querySelector(".c-home"),chapter=document.querySelector(".c-chapter"),nextButton=document.querySelector(".c-next__button"),chapterContainer=document.querySelector(".c-chapter-container"),v=document.getElementById("v"),chapterButton=document.querySelectorAll(".c-chapter__button"),floatingNavToggle=document.querySelector(".c-chapter-menu__toggle"),floatingNavLink=document.querySelectorAll(".c-chapter__link"),vw=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;document.addEventListener("scroll",function(){titleSVGPos()<-vh/2?titleSVG.classList.remove("visible"):titleSVG.classList.add("visible"),csgPos()<vh-150&&csgPos()>150-vh?chapterSlideGrid.classList.add("visible"):chapterSlideGrid.classList.remove("visible"),vw>900?chapterMenuPos()<vh/20?chapterMenu.classList.add("sticky"):chapterMenu.classList.remove("sticky"):chapterMenu.classList.add("sticky")}),floatingNavToggle.addEventListener("click",function(){this.classList.toggle("js-revealed")}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("v"),t=document.getElementById("c"),n=t.getContext("2d"),o=Math.floor(t.clientWidth/100),r=Math.floor(t.clientHeight/100);t.width=o,t.height=r,vw>600?e.playbackRate=.2:e.pause(),e.addEventListener("play",function(){draw(this,n,o,r)},!1),nextButton.addEventListener("click",function(){getChapter(1)},!1),floatingNav()},!1);